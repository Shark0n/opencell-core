<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui" xmlns:cc="http://java.sun.com/jsf/composite" xmlns:s="http://jboss.org/seam/faces" xmlns:hftl="http://hftl.org"
    xmlns:c="http://java.sun.com/jsp/jstl/core">

<cc:interface>

</cc:interface>

<cc:implementation>
    <span id="#{cc.clientId}" style="white-space: nowrap"> 
        <hftl:decorateFormField fieldId="#{cc.attrs.fieldIdPrefix}#{cc.attrs.popup?'_child':'_list'}"
            label="#{cc.attrs.label}" componentWidth="#{cc.attrs.componentWidth}" newLine="#{cc.attrs.newLine}" displayOneLine="#{cc.attrs.displayOneLine}"
            styleClass="#{cc.attrs.styleClass}" style="#{cc.attrs.style}" labelStyle="#{cc.attrs.labelStyle}" labelStyleClass="#{cc.attrs.labelStyleClass}"
            inputStyle="#{cc.attrs.inputStyle}" inputStyleClass="#{cc.attrs.inputStyleClass}" labelWidth="#{cc.attrs.labelWidth}" inputWidth="#{cc.attrs.inputWidth}">


            <!-- Entity selection via popup -->
            <c:if test="#{cc.attrs.popup}">
                <h:panelGroup>
                    <p:inputText id="#{cc.attrs.fieldIdPrefix}_child" value="#{cc.attrs.backingBean.filters[cc.attrs.field][cc.attrs.valueLabelField]}" size="#{cc.attrs.size}"
                        disabled="true" />
                    <p:commandButton id="selectLink" onclick="PF('dlg_#{cc.attrs.popupId}').show()" icon="ui-icon-search" type="button" />
                    <p:tooltip for="selectLink" value="#{messages['commons.search']}" />
                </h:panelGroup>
            </c:if>

            <!-- Entity selection from a picklist -->
            <c:if test="#{!cc.attrs.popup}">

                <c:if test="#{cc.attrs.listElements==null}">
                    <c:set var="elements" value="#{cc.attrs.listBean.listAll()}" />
                </c:if>
                <c:if test="#{cc.attrs.listElements!=null}">
                    <c:set var="elements" value="#{cc.attrs.listElements}" />
                </c:if>

                <p:selectOneMenu id="#{cc.attrs.fieldIdPrefix}_list" value="#{cc.attrs.backingBean.filters[cc.attrs.field]}">
                    <f:selectItem itemLabel="" itemValue="" />
                    <f:selectItems value="#{elements}" var="elem" itemLabel="#{elem[cc.attrs.valueLabelField]}" itemValue="#{elem}" />
                    <s:objectConverter />
                </p:selectOneMenu>
            </c:if>
        </hftl:decorateFormField>
    </span>
</cc:implementation>

</html>
